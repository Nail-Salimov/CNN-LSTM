Модель на основе CNN-LSTM для прогнозирования цен на акции
==========================================================

Данные о ценах на акции имеют характеристики временных рядов. В то же
время, на основе долгой краткосрочной памяти машинного обучения (LSTM),
которая имеет преимущества анализа взаимосвязей между данными временных
рядов с помощью функции памяти, встатье предлагается метод
прогнозирования курса акций на основе CNN-LSTM. Результат гибрида
сравнивался с результатами MLP, CNN, RNN, LSTM, CNN-RNN и другие модели
прогнозирования.

Данные, использованные в этом исследовании, касаются дневных цен на
акции с 1 июля 1991 г. по 31 августа 2020 г., включая 7127 торговых
дней. Выбираны восемь характеристик, включая цену открытия, максимальную
цену, минимальную цену, цену закрытия, объем, оборот, взлеты и падения и
изменения. CNN применяется для эффективного извлечения характеристик из
данных, которые являются элементами за предыдущие 10 дней. А затем мы
применяется LSTM для прогнозирования курса акций на основе извлеченных
данных характеристик. Согласно результатам экспериментов, CNN-LSTM может
обеспечить надежное прогнозирование курса акций с высочайшей точностью
прогноза. Этот метод прогнозирования не только дает новую
исследовательскую идею для прогнозирования цен на акции, но и дает
ученым практический опыт изучения данных финансовых временных рядов.

##### <span id="anchor"></span>Модель CNN-LSTM

CNN имеет свойство обращать внимание на наиболее очевидные особенности в
прямой видимости, поэтому он широко используется в проектировании
признаков. LSTM имеет свойство расширяться в соответствии с
последовательностью времени и широко используется во временных рядах. В
соответствии с характеристиками CNN и LSTM устанавливается модель
прогнозирования запасов на основе CNN-LSTM. Схема структуры модели
показана на рисунке, а основная структура - это CNN и LSTM, включая
входной уровень, одномерный слой свертки, уровень объединения, скрытый
слой LSTM и уровень полного соединения.

##### <span id="anchor-1"></span>CNN

CNN - сетевая модель, предложенная Lecun et al. в 1998 г. CNN - это
своего рода нейронная сеть с прямой связью, которая обладает хорошей
производительностью при обработке изображений и обработке естественного
языка. Его можно эффективно применять для прогнозирования временных
рядов. Локальное восприятие и распределение веса CNN может значительно
уменьшить количество параметров, тем самым повышая эффективность
обучения модели. CNN в основном состоит из двух частей: сверточного слоя
и объединяющего слоя. Каждый слой свертки содержит множество ядер
свертки, и его формула расчета показана в формуле. После операции
свертки сверточного слоя признаки данных извлекаются, но размеры
извлеченных признаков очень высоки, поэтому для решения этой проблемы и
снижения затрат на обучение сети после свертки добавляется слой
объединения. слой, чтобы уменьшить размер объекта:

где представляет выходное значение после свертки, tanh - функция
активации, x - входной вектор, k - вес ядра свертки и b - смещение ядра
свертки.

##### LSTM

LSTM - это сетевая модель, предложенная Шмидхубером и др. в 1997 г. LSTM
- это сетевая модель, разработанная для решения давних проблем
градиентного взрыва и исчезновения градиента в RNN. Он широко
используется в распознавании речи, эмоциональном анализе и анализе
текста, поскольку имеет собственную память и может делать относительно
точные прогнозы. В последние годы он стал применяться и в области
прогнозирования фондового рынка. В стандартной RNN есть только один
повторяющийся модуль, и его внутренняя структура проста. Обычно это
загар. Однако четыре модуля LSTM аналогичны стандартным модулям RNN и
работают особым интерактивным образом. Ячейка памяти LSTM состоит из
трех частей: затвора забывания, входного затвора и выходного затвора,
как показано на рисунке.

Процесс расчета LSTM выглядит следующим образом:

где диапазон значений равен f (0,1), W- вес элемента забывания, b-
смещение элемента забывания, x- входное значение текущего времени и h-
выходное значение последнего момента.

\
где диапазон значений i равен (0,1), Wi - вес входного элемента, b\_i-
смещение входного элемента, Wc- вес входного элемента-кандидата, и b\_c
- смещение входного элемента-кандидата

\
3) Обновите текущее состояние ячейки следующим образом:

\
где диапазон значений C\_t равен

4\) Выход h и вход x принимаются как входные значения выходного элемента
в момент времени t , а выходной o сигнал выходного элемента получается
следующим образом

\
где диапазон значений o равен (0,1), W- вес выходного элемента, а b-
смещение выходного элемента.

5\) Выходное значение LSTM получается путем вычисления выходного сигнала
выходного вентиля и состояния ячейки, как показано в следующей формуле

##### <span id="anchor-2"></span>Процесс обучения и прогнозирования CNN-LSTM

Основные шаги следующие:

##### <span id="anchor-3"></span>Данные

В этом эксперименте в качестве экспериментальных данных выбран Shanghai
Composite Index (000001). Ежедневные торговые данные за 7127 торговых
дней с 1 июля 1991 г. по 31 августа 2020 г. получены из базы данных
wind. Каждый фрагмент данных содержит восемь элементов, а именно цену
открытия, максимальную цену, минимальную цену, цену закрытия, объем,
оборот, взлеты и падения и изменения. Некоторые данные представлены в
таблице.

##### <span id="anchor-4"></span>Реализация модели

Чтобы оценить эффект прогнозирования CNN-LSTM, в качестве критериев
оценки методов используются средняя абсолютная ошибка (MAE),
среднеквадратичная ошибка (RMSE) и *R-*квадрат.

#### <span id="anchor-5"></span>Результаты

После использования обработанных данных обучающего набора для обучения
MLP, CNN, RNN, LSTM CNN-RNN и CNN-LSTM, соответственно, модель,
завершенная обучением, используется для прогнозирования данных тестового
набора, а реальное значение сравнивается с прогнозируемым. значение
, как показано на рисунках

Результаты показывают, что производительность CNN-LSTM является лучшей
среди шести методов. Что касается точности прогнозирования, MAE
составляет 27,564, а RMSE - 39,688, что является наименьшим среди шести
моделей прогнозирования и имеет высокую точность прогнозирования с точки
зрения эффективности прогнозирования, а *R\^*2  CNN-LSTM составляет
0,9646, что улучшено на 2,2%, 0,6%, 0,5% и 0,2% соответственно по
сравнению с четырьмя другими методами. Следовательно, CNN-LSTM,
предложенная в этой статье, превосходит другие четыре сравнительные
модели с точки зрения степени соответствия и значения ошибки. Он может
хорошо предсказывать цену закрытия следующего дня и служить ориентиром
для инвестиций инвесторов.

#### <span id="anchor-6"></span>Выводы

Согласно хронологическим характеристикам данных о ценах на акции, в этой
статье предлагается CNN-LSTM для прогнозирования цены закрытия акций на
следующий день. В этом методе в качестве входных данных используются
цена открытия, максимальная цена, минимальная цена, цена закрытия,
объем, оборот, взлеты и падения, а также изменение данных о запасах,
полностью используя характеристики временной последовательности данных о
запасах. CNN используется для извлечения характеристик входных данных.
LSTM используется для изучения извлеченных данных характеристик и
прогнозирования цены закрытия акции на следующий день. В этой статье в
качестве примера для проверки экспериментальных результатов используются
соответствующие данные Shanghai Composite Index. Результаты
экспериментов показывают, что CNN-LSTM имеет самую высокую точность
прогнозирования и лучшую производительность по сравнению с MLP, CNN,
RNN, LSTM и CNN-RNN. MAE и RMSE - самые маленькие из всех методов,*R\^*2
близок к 1. CNN-LSTM подходит для прогнозирования цен на акции и может
служить релевантным ориентиром для инвесторов, чтобы максимизировать
отдачу от инвестиций. CNN-LSTM также предлагает практический опыт
исследования данных финансовых временных рядов. Однако у модели все же
есть недостатки. Например, он учитывает только влияние данных о ценах
акций на цены закрытия и не учитывает эмоциональные факторы, такие как
новости и национальная политика, в прогнозе. Наша будущая
исследовательская работа в основном направлена на усиление анализа
настроений в отношении новостей, связанных с акциями, и национальной
политики, чтобы обеспечить точность прогнозов по запасам.
